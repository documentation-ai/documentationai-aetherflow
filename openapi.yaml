openapi: '3.0.3'
info:
  version: 1.0.0
  title: AetherFlow API
  description: |
    AetherFlow is an AI-powered workflow automation platform that helps teams automate complex business processes through intelligent document processing and multi-step workflows.

    ## Authentication
    All API requests require authentication using Bearer tokens. Include your API key in the Authorization header: `Authorization: Bearer your_api_key`

    ## Rate Limits
    - 1000 requests per hour for read operations
    - 100 requests per hour for write operations
    - 10 concurrent workflow executions per organization

    ## Base URL
    All API requests should be made to: `https://api.aetherflow.com/v1`
  contact:
    email: support@aetherflow.com
    url: https://docs.aetherflow.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
servers:
  - url: https://api.aetherflow.com/v1
    description: Production API server
  - url: https://staging-api.aetherflow.com/v1
    description: Staging API server
paths:
  /workflows:
    get:
      tags:
        - Workflows
      summary: List all workflows
      description: Retrieve a paginated list of workflows belonging to the authenticated organization. Workflows are returned in descending order of creation date.
      operationId: listWorkflows
      security:
        - bearerAuth: []
      parameters:
        - name: limit
          in: query
          description: Maximum's number of workflows to return (1-100, default 20)
          required: false
          schema:
            type: integer
            format: int32
            minimum: 1
            maximum: 100
            default: 20
        - name: offset
          in: query
          description: Number of workflows to skip for pagination
          required: false
          schema:
            type: integer
            format: int32
            minimum: 0
            default: 0
        - name: status
          in: query
          description: Filter workflows by status
          required: false
          schema:
            type: string
            enum: [active, inactive, draft]
        - name: tags
          in: query
          description: Filter workflows by tags (comma-separated)
          required: false
          schema:
            type: string
      responses:
        '200':
          description: Successful response with paginated workflow list
          headers:
            x-total-count:
              description: Total number of workflows matching the query
              schema:
                type: integer
            x-next:
              description: Link to next page of results
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkflowListResponse'
              example:
                workflows:
                  - id: "wf_123456"
                    name: "Invoice Processing Workflow"
                    description: "Automatically processes incoming invoices and extracts key information"
                    status: "active"
                    created_at: "2024-01-15T10:30:00Z"
                    updated_at: "2024-01-20T14:45:00Z"
                    tags: ["finance", "automation"]
                    steps_count: 5
                total: 1
                limit: 20
                offset: 0
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: 400
                message: "Invalid status filter. Must be one of: active, inactive, draft"
                details: { "status": "invalid_status" }
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      tags:
        - Workflows
      summary: Create a new workflow
      description: Create a new workflow with the specified configuration. The workflow will be created in draft status and can be activated later.
      operationId: createWorkflow
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateWorkflowRequest'
            example:
              name: "Document Classification Workflow"
              description: "Automatically classifies and routes incoming documents based on content analysis"
              steps:
                - type: "document_upload"
                  config:
                    allowed_formats: ["pdf", "docx", "png", "jpg"]
                - type: "ai_analysis"
                  config:
                    model: "gpt-4"
                    prompt: "Analyze this document and classify it into categories: invoice, contract, report, or other"
                - type: "conditional_routing"
                  config:
                    conditions:
                      - field: "classification"
                        operator: "equals"
                        value: "invoice"
                        action: "route_to_finance"
              tags: ["document-processing", "ai-powered"]
              settings:
                timeout_minutes: 30
                retry_count: 3
                notifications:
                  on_success: true
                  on_failure: true
      responses:
        '201':
          description: Workflow created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Workflow'
              example:
                id: "wf_123456"
                name: "Document Classification Workflow"
                description: "Automatically classifies and routes incoming documents based on content analysis"
                status: "draft"
                created_at: "2024-01-15T10:30:00Z"
                updated_at: "2024-01-15T10:30:00Z"
                tags: ["document-processing", "ai-powered"]
                steps_count: 3
                settings:
                  timeout_minutes: 30
                  retry_count: 3
        '400':
          description: Invalid workflow configuration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: 400
                message: "Workflow validation failed"
                details:
                  steps: ["Step 1: Missing required config field 'model'"]
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workflows/{workflowId}:
    get:
      tags:
        - Workflows
      summary: Retrieve a specific workflow
      description: Get detailed information about a specific workflow, including its configuration, steps, and execution history.
      operationId: getWorkflowById
      security:
        - bearerAuth: []
      parameters:
        - name: workflowId
          in: path
          required: true
          description: "The unique identifier of the workflow (format: wf_xxxxxxxx)"
          schema:
            type: string
            pattern: '^wf_[a-zA-Z0-9]{8,}$'
            example: "wf_12345678"
        - name: include_steps
          in: query
          description: Include detailed step configuration in the response
          required: false
          schema:
            type: boolean
            default: false
        - name: include_executions
          in: query
          description: Include recent execution history (last 10 executions)
          required: false
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: Workflow retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkflowDetail'
              example:
                id: "wf_12345678"
                name: "Invoice Processing Workflow"
                description: "Automatically processes incoming invoices and extracts key information"
                status: "active"
                created_at: "2024-01-15T10:30:00Z"
                updated_at: "2024-01-20T14:45:00Z"
                tags: ["finance", "automation"]
                steps_count: 5
                settings:
                  timeout_minutes: 30
                  retry_count: 3
                  notifications:
                    on_success: true
                    on_failure: true
                steps:
                  - id: "step_1"
                    type: "document_upload"
                    name: "Upload Invoice"
                    order: 1
                    config:
                      allowed_formats: ["pdf", "png", "jpg"]
                  - id: "step_2"
                    type: "ai_extraction"
                    name: "Extract Invoice Data"
                    order: 2
                    config:
                      model: "gpt-4-vision"
                      fields: ["invoice_number", "total_amount", "vendor_name", "due_date"]
                recent_executions:
                  - id: "exec_abc123"
                    status: "completed"
                    started_at: "2024-01-20T14:30:00Z"
                    completed_at: "2024-01-20T14:32:15Z"
                    duration_seconds: 135
        '404':
          description: Workflow not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: 404
                message: "Workflow with ID 'wf_invalid' not found"
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    put:
      tags:
        - Work
      summary: Update a workflow
      description: Update an existing workflow's configuration, steps, or settings.
      operationId: updateWorkflow
      security:
        - bearerAuth: []
      parameters:
        - name: workflowId
          in: path
          required: true
          description: The unique identifier of the workflow to update
          schema:
            type: string
            pattern: '^wf_[a-zA-Z0-9]{8,}$'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateWorkflowRequest'
      responses:
        '200':
          description: Workflow updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Workflow'
        '404':
          description: Workflow not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '400':
          description: Invalid update request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    delete:
      tags:
        - Workflows
      summary: Delete a workflow
      description: Permanently delete a workflow and all its associated data. This action cannot be undone.
      operationId: deleteWorkflow
      security:
        - bearerAuth: []
      parameters:
        - name: workflowId
          in: path
          required: true
          description: The unique identifier of the workflow to delete
          schema:
            type: string
            pattern: '^wf_[a-zA-Z0-9]{8,}$'
      responses:
        '204':
          description: Workflow deleted successfully
        '404':
          description: Workflow not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /integrations:
    get:
      tags:
        - Integrations
      summary: List connected integrations
      description: Retrieve all integrations connected to your organization, with optional filtering by type or status.
      operationId: listIntegrations
      security:
        - bearerAuth: []
      parameters:
        - name: type
          in: query
          description: Filter by integration type
          required: false
          schema:
            type: string
            enum: [communication, productivity, storage, finance, crm, analytics]
        - name: status
          in: query
          description: Filter by connection status
          required: false
          schema:
            type: string
            enum: [connected, disconnected, error, pending]
      responses:
        '200':
          description: List of integrations retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IntegrationListResponse'
              example:
                integrations:
                  - id: "int_slack_001"
                    name: "Slack Workspace"
                    type: "communication"
                    app: "slack"
                    status: "connected"
                    connected_at: "2024-01-10T09:15:00Z"
                    last_sync: "2024-01-20T16:30:00Z"
                    config:
                      workspace_name: "AetherFlow Team"
                      channels: ["#workflows", "#alerts"]
                  - id: "int_gdrive_002"
                    name: "Google Drive"
                    type: "storage"
                    app: "google_drive"
                    status: "connected"
                    connected_at: "2024-01-12T11:20:00Z"
                    last_sync: "2024-01-20T15:45:00Z"
                    config:
                      shared_drive: "AetherFlow Documents"
                total: 2
        '401':
          description: Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      tags:
        - Integrations
      summary: Connect a new integration
      description: Connect a new third-party service to your AetherFlow organization. This will initiate the OAuth flow or API key validation process.
      operationId: createIntegration
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateIntegrationRequest'
            examples:
              oauth_integration:
                summary: OAuth-based integration (Slack, Google Drive)
                value:
                  app: "slack"
                  type: "communication"
                  config:
                    scopes: ["channels:read", "chat:write", "files:read"]
                    redirect_uri: "https://app.aetherflow.com/integrations/oauth/callback"
              api_key_integration:
                summary: API key-based integration
                value:
                  app: "webhook"
                  type: "communication"
                  config:
                    webhook_url: "https://myapp.com/aetherflow-webhook"
                    secret: "whsec_abcdef123456"
                    events: ["workflow.completed", "workflow.failed"]
      responses:
        '201':
          description: Integration connection initiated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Integration'
              example:
                id: "int_slack_001"
                name: "Slack Workspace"
                type: "communication"
                app: "slack"
                status: "pending"
                created_at: "2024-01-20T16:45:00Z"
                config:
                  authorization_url: "https://slack.com/oauth/authorize?client_id=...&scope=channels:read,chat:write"
        '400':
          description: Invalid integration configuration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: 400
                message: "Unsupported integration type"
                details: { "supported_apps": ["slack", "google_drive", "webhook", "zapier"] }
        '409':
          description: Integration already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: 409
                message: "Slack integration already connected to this workspace"
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /workflows/{workflowId}/execute:
    post:
      tags:
        - Workflows
      summary: Execute a workflow
      description: Manually trigger the execution of a workflow with optional input data.
      operationId: executeWorkflow
      security:
        - bearerAuth: []
      parameters:
        - name: workflowId
          in: path
          required: true
          description: The unique identifier of the workflow to execute
          schema:
            type: string
            pattern: '^wf_[a-zA-Z0-9]{8,}$'
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExecuteWorkflowRequest'
            example:
              inputs:
                document_url: "https://example.com/invoice.pdf"
                priority: "high"
              metadata:
                source: "api_call"
                user_id: "user_123"
      responses:
        '202':
          description: Workflow execution started
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExecutionResponse'
        '404':
          description: Workflow not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '400':
          description: Invalid execution request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /executions/{executionId}:
    get:
      tags:
        - Executions
      summary: Get execution details
      description: Retrieve detailed information about a specific workflow execution, including logs and results.
      operationId: getExecution
      security:
        - bearerAuth: []
      parameters:
        - name: executionId
          in: path
          required: true
          description: The unique identifier of the execution
          schema:
            type: string
            pattern: '^exec_[a-zA-Z0-9]{8,}$'
      responses:
        '200':
          description: Execution details retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExecutionDetail'
        '404':
          description: Execution not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /webhooks:
    get:
      tags:
        - Webhooks
      summary: List webhooks
      description: Retrieve all configured webhooks for workflow events.
      operationId: listWebhooks
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Webhooks retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WebhookListResponse'
    post:
      tags:
        - Webhooks
      summary: Create webhook
      description: Create a new webhook endpoint to receive workflow execution events.
      operationId: createWebhook
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateWebhookRequest'
      responses:
        '201':
          description: Webhook created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Webhook'
  /analytics/workflows:
    get:
      tags:
        - Analytics
      summary: Get workflow analytics
      description: Retrieve analytics and metrics about workflow performance and usage.
      operationId: getWorkflowAnalytics
      security:
        - bearerAuth: []
      parameters:
        - name: period
          in: query
          description: "Time period for analytics (default: 30d)"
          required: false
          schema:
            type: string
            enum: [7d, 30d, 90d, 1y]
            default: "30d"
      responses:
        '200':
          description: Analytics data retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnalyticsResponse'
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: API key authentication using Bearer token

  schemas:
    # Error Schema
    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: integer
          format: int32
          description: HTTP status code
          example: 400
        message:
          type: string
          description: Human-readable error message
          example: "Invalid request parameters"
        details:
          type: object
          description: Additional error details
          example: { "field": "name", "reason": "required" }
        request_id:
          type: string
          description: Unique request identifier for debugging
          example: "req_abc123def456"

    # Workflow Schemas
    Workflow:
      type: object
      required:
        - id
        - name
        - status
        - created_at
        - updated_at
      properties:
        id:
          type: string
          pattern: '^wf_[a-zA-Z0-9]{8,}$'
          description: Unique workflow identifier
          example: "wf_12345678"
        name:
          type: string
          maxLength: 100
          description: Human-readable workflow name
          example: "Invoice Processing Workflow"
        description:
          type: string
          maxLength: 500
          description: Detailed workflow description
          example: "Automatically processes incoming invoices and extracts key information"
        status:
          type: string
          enum: [active, inactive, draft, archived]
          description: Current workflow status
          example: "active"
        created_at:
          type: string
          format: date-time
          description: When the workflow was created
          example: "2024-01-15T10:30:00Z"
        updated_at:
          type: string
          format: date-time
          description: When the workflow was last updated
          example: "2024-01-20T14:45:00Z"
        tags:
          type: array
          items:
            type: string
          maxItems: 10
          description: Tags for organizing workflows
          example: ["finance", "automation"]
        steps_count:
          type: integer
          minimum: 1
          maximum: 50
          description: Number of steps in the workflow
          example: 5
        settings:
          $ref: '#/components/schemas/WorkflowSettings'

    WorkflowListResponse:
      type: object
      required:
        - workflows
        - total
        - limit
        - offset
      properties:
        workflows:
          type: array
          items:
            $ref: '#/components/schemas/Workflow'
        total:
          type: integer
          description: Total number of workflows matching the query
          example: 25
        limit:
          type: integer
          description: Requested limit
          example: 20
        offset:
          type: integer
          description: Requested offset
          example: 0

    WorkflowDetail:
      allOf:
        - $ref: '#/components/schemas/Workflow'
        - type: object
          properties:
            steps:
              type: array
              items:
                $ref: '#/components/schemas/WorkflowStep'
              description: Detailed step configurations (only included when requested)
            recent_executions:
              type: array
              items:
                $ref: '#/components/schemas/ExecutionSummary'
              maxItems: 10
              description: Recent execution history (only included when requested)

    WorkflowStep:
      type: object
      required:
        - id
        - type
        - name
        - order
        - config
      properties:
        id:
          type: string
          pattern: '^step_[a-zA-Z0-9]{8,}$'
          description: Unique step identifier
          example: "step_abc123"
        type:
          type: string
          enum: [document_upload, ai_analysis, ai_extraction, conditional_routing, webhook, email_notification, api_call, database_query]
          description: Type of workflow step
          example: "ai_extraction"
        name:
          type: string
          maxLength: 100
          description: Human-readable step name
          example: "Extract Invoice Data"
        order:
          type: integer
          minimum: 1
          description: Execution order of the step
          example: 2
        config:
          type: object
          description: Step-specific configuration
          example: { "model": "gpt-4-vision", "fields": ["invoice_number", "total_amount"] }
        depends_on:
          type: array
          items:
            type: string
          description: IDs of steps this step depends on
          example: ["step_xyz789"]

    WorkflowSettings:
      type: object
      properties:
        timeout_minutes:
          type: integer
          minimum: 1
          maximum: 1440
          default: 60
          description: Maximum execution time in minutes
          example: 30
        retry_count:
          type: integer
          minimum: 0
          maximum: 10
          default: 0
          description: Number of retry attempts on failure
          example: 3
        retry_delay_seconds:
          type: integer
          minimum: 1
          maximum: 3600
          default: 60
          description: Delay between retry attempts
          example: 300
        notifications:
          type: object
          properties:
            on_success:
              type: boolean
              default: false
              description: Send notifications on successful execution
            on_failure:
              type: boolean
              default: true
              description: Send notifications on execution failure
            email_recipients:
              type: array
              items:
                type: string
                format: email
              maxItems: 10
              description: Email addresses to notify

    CreateWorkflowRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          maxLength: 100
          description: Workflow name
        description:
          type: string
          maxLength: 500
          description: Workflow description
        steps:
          type: array
          items:
            $ref: '#/components/schemas/WorkflowStep'
          minItems: 1
          maxItems: 50
          description: Workflow steps configuration
        tags:
          type: array
          items:
            type: string
          maxItems: 10
          description: Workflow tags
        settings:
          $ref: '#/components/schemas/WorkflowSettings'

    UpdateWorkflowRequest:
      type: object
      properties:
        name:
          type: string
          maxLength: 100
          description: Updated workflow name
        description:
          type: string
          maxLength: 500
          description: Updated workflow description
        steps:
          type: array
          items:
            $ref: '#/components/schemas/WorkflowStep'
          minItems: 1
          maxItems: 50
          description: Updated workflow steps
        tags:
          type: array
          items:
            type: string
          maxItems: 10
          description: Updated workflow tags
        settings:
          $ref: '#/components/schemas/WorkflowSettings'
        status:
          type: string
          enum: [active, inactive, draft]
          description: Update workflow status

    # Execution Schemas
    ExecutionSummary:
      type: object
      required:
        - id
        - status
        - started_at
      properties:
        id:
          type: string
          pattern: '^exec_[a-zA-Z0-9]{8,}$'
          description: Unique execution identifier
          example: "exec_abc123"
        status:
          type: string
          enum: [pending, running, completed, failed, cancelled]
          description: Execution status
          example: "completed"
        started_at:
          type: string
          format: date-time
          description: When execution started
          example: "2024-01-20T14:30:00Z"
        completed_at:
          type: string
          format: date-time
          description: When execution finished (null if still running)
          example: "2024-01-20T14:32:15Z"
        duration_seconds:
          type: integer
          description: Total execution time in seconds
          example: 135

    ExecutionDetail:
      allOf:
        - $ref: '#/components/schemas/ExecutionSummary'
        - type: object
          properties:
            workflow_id:
              type: string
              pattern: '^wf_[a-zA-Z0-9]{8,}$'
              description: ID of the executed workflow
            inputs:
              type: object
              description: Input data provided to the execution
            outputs:
              type: object
              description: Output data produced by the execution
            steps:
              type: array
              items:
                $ref: '#/components/schemas/ExecutionStep'
              description: Detailed step execution results
            logs:
              type: array
              items:
                $ref: '#/components/schemas/ExecutionLog'
              description: Execution logs and events

    ExecutionStep:
      type: object
      required:
        - step_id
        - status
        - started_at
      properties:
        step_id:
          type: string
          pattern: '^step_[a-zA-Z0-9]{8,}$'
          description: ID of the workflow step
        status:
          type: string
          enum: [pending, running, completed, failed, skipped]
          description: Step execution status
        started_at:
          type: string
          format: date-time
          description: When step execution started
        completed_at:
          type: string
          format: date-time
          description: When step execution finished
        duration_seconds:
          type: integer
          description: Step execution time
        output:
          type: object
          description: Step output data
        error:
          type: string
          description: Error message if step failed

    ExecutionLog:
      type: object
      required:
        - timestamp
        - level
        - message
      properties:
        timestamp:
          type: string
          format: date-time
          description: Log entry timestamp
        level:
          type: string
          enum: [info, warn, error, debug]
          description: Log level
        message:
          type: string
          description: Log message
        step_id:
          type: string
          pattern: '^step_[a-zA-Z0-9]{8,}$'
          description: Associated step ID

    ExecuteWorkflowRequest:
      type: object
      properties:
        inputs:
          type: object
          description: Input data for workflow execution
          example: { "document_url": "https://example.com/file.pdf", "priority": "high" }
        metadata:
          type: object
          description: Additional metadata for tracking
          example: { "source": "api_call", "user_id": "user_123" }
        async:
          type: boolean
          default: true
          description: Whether to execute asynchronously

    ExecutionResponse:
      type: object
      required:
        - execution_id
        - status
      properties:
        execution_id:
          type: string
          pattern: '^exec_[a-zA-Z0-9]{8,}$'
          description: Unique execution identifier
          example: "exec_abc123def"
        status:
          type: string
          enum: [queued, running]
          description: Initial execution status
          example: "queued"
        estimated_duration_seconds:
          type: integer
          description: Estimated completion time
          example: 300
        webhook_url:
          type: string
          format: uri
          description: Webhook URL for execution status updates

    # Integration Schemas
    Integration:
      type: object
      required:
        - id
        - name
        - type
        - app
        - status
      properties:
        id:
          type: string
          pattern: '^int_[a-zA-Z0-9_]{8,}$'
          description: Unique integration identifier
          example: "int_slack_001"
        name:
          type: string
          description: Human-readable integration name
          example: "Slack Workspace"
        type:
          type: string
          enum: [communication, productivity, storage, finance, crm, analytics]
          description: Category of integration
          example: "communication"
        app:
          type: string
          enum: [slack, google_drive, microsoft_teams, webhook, zapier, salesforce, hubspot, dropbox]
          description: Specific application/service
          example: "slack"
        status:
          type: string
          enum: [connected, disconnected, error, pending]
          description: Connection status
          example: "connected"
        created_at:
          type: string
          format: date-time
          description: When integration was created
        connected_at:
          type: string
          format: date-time
          description: When integration was last connected
        last_sync:
          type: string
          format: date-time
          description: When data was last synchronized
        config:
          type: object
          description: Integration-specific configuration
          example: { "workspace_name": "AetherFlow Team", "channels": ["#workflows"] }
        error_message:
          type: string
          description: Last error message if status is 'error'

    IntegrationListResponse:
      type: object
      required:
        - integrations
        - total
      properties:
        integrations:
          type: array
          items:
            $ref: '#/components/schemas/Integration'
        total:
          type: integer
          description: Total number of integrations
          example: 3

    CreateIntegrationRequest:
      type: object
      required:
        - app
        - type
      properties:
        app:
          type: string
          enum: [slack, google_drive, microsoft_teams, webhook, zapier, salesforce, hubspot, dropbox]
          description: Application to integrate
        type:
          type: string
          enum: [communication, productivity, storage, finance, crm, analytics]
          description: Integration category
        config:
          type: object
          description: Integration-specific configuration
          example: { "scopes": ["channels:read", "chat:write"], "redirect_uri": "https://app.aetherflow.com/callback" }

    # Webhook Schemas
    Webhook:
      type: object
      required:
        - id
        - url
        - events
        - status
      properties:
        id:
          type: string
          pattern: '^wh_[a-zA-Z0-9]{8,}$'
          description: Unique webhook identifier
          example: "wh_12345678"
        url:
          type: string
          format: uri
          description: Webhook endpoint URL
          example: "https://myapp.com/aetherflow-webhook"
        events:
          type: array
          items:
            type: string
            enum: [workflow.started, workflow.completed, workflow.failed, execution.step_completed, execution.step_failed]
          minItems: 1
          description: Events to trigger webhook
          example: ["workflow.completed", "workflow.failed"]
        status:
          type: string
          enum: [active, inactive, failed]
          description: Webhook status
          example: "active"
        secret:
          type: string
          description: Secret for webhook signature verification
          example: "whsec_abcdef123456"
        created_at:
          type: string
          format: date-time
          description: When webhook was created
        last_triggered:
          type: string
          format: date-time
          description: When webhook was last triggered

    WebhookListResponse:
      type: object
      required:
        - webhooks
        - total
      properties:
        webhooks:
          type: array
          items:
            $ref: '#/components/schemas/Webhook'
        total:
          type: integer
          description: Total number of webhooks

    CreateWebhookRequest:
      type: object
      required:
        - url
        - events
      properties:
        url:
          type: string
          format: uri
          description: Webhook endpoint URL
        events:
          type: array
          items:
            type: string
            enum: [workflow.started, workflow.completed, workflow.failed, execution.step_completed, execution.step_failed]
          minItems: 1
          description: Events to trigger webhook
        secret:
          type: string
          minLength: 16
          description: Secret for webhook signature verification

    # Analytics Schemas
    AnalyticsResponse:
      type: object
      required:
        - period
        - total_executions
        - successful_executions
        - failed_executions
      properties:
        period:
          type: string
          enum: [7d, 30d, 90d, 1y]
          description: Time period for analytics
          example: "30d"
        total_executions:
          type: integer
          description: Total workflow executions
          example: 1250
        successful_executions:
          type: integer
          description: Number of successful executions
          example: 1180
        failed_executions:
          type: integer
          description: Number of failed executions
          example: 70
        average_duration_seconds:
          type: integer
          description: Average execution duration
          example: 245
        workflows_by_status:
          type: object
          properties:
            active:
              type: integer
              example: 15
            inactive:
              type: integer
              example: 3
            draft:
              type: integer
              example: 2
        executions_by_workflow:
          type: array
          items:
            type: object
            properties:
              workflow_id:
                type: string
                example: "wf_12345678"
              workflow_name:
                type: string
                example: "Invoice Processing"
              executions:
                type: integer
                example: 450
              success_rate:
                type: number
                format: float
                minimum: 0
                maximum: 1
                example: 0.94
        daily_stats:
          type: array
          items:
            type: object
            properties:
              date:
                type: string
                format: date
                example: "2024-01-20"
              executions:
                type: integer
                example: 45
              success_rate:
                type: number
                format: float
                example: 0.96